{"version":3,"file":"index.js","sources":["index.js"],"sourcesContent":["import MagicString from \"magic-string\";\nimport { walk } from \"estree-walker\";\nimport { createFilter } from \"rollup-pluginutils\";\n\nfunction nodeToCdn({ include, exclude, files = {} } = {}) {\n  const filter = createFilter(include, exclude);\n\n  return {\n    name: \"localToCDN\",\n    options: opts => {\n      return { ...opts, external: [...opts.external, ...Object.keys(files)] };\n    },\n    transform(code, id) {\n      if (!filter(id)) return;\n\n      const ast = this.parse(code);\n      const _code = new MagicString(code);\n      walk(ast, {\n        enter: function(node, parent) {\n          if (\n            parent &&\n            parent.type === \"ImportDeclaration\" &&\n            node.type === \"Literal\"\n          ) {\n            const cdnLocation = files[node.value];\n            if (cdnLocation) {\n              // +1 and -1 are to ignore the qoutes around the string\n              _code.overwrite(node.start + 1, node.end - 1, cdnLocation);\n            }\n          }\n        }\n      });\n      return {\n        code: _code.toString(),\n        map: _code.generateMap()\n      };\n    }\n  };\n}\n\nexport default nodeToCdn;\n"],"names":["nodeToCdn","include","exclude","files","filter","createFilter","name","options","opts","external","Object","keys","transform","code","id","ast","parse","_code","MagicString","walk","enter","node","parent","type","cdnLocation","value","overwrite","start","end","toString","map","generateMap"],"mappings":";;;;;;;;AAIA,SAASA,SAAT,CAAmB;EAAEC,OAAF;EAAWC,OAAX;EAAoBC,KAAK,GAAG;IAAO,EAAtD,EAA0D;QAClDC,MAAM,GAAGC,8BAAY,CAACJ,OAAD,EAAUC,OAAV,CAA3B;SAEO;IACLI,IAAI,EAAE,YADD;IAELC,OAAO,EAAEC,IAAI,IAAI;aACR,EAAE,GAAGA,IAAL;QAAWC,QAAQ,EAAE,CAAC,GAAGD,IAAI,CAACC,QAAT,EAAmB,GAAGC,MAAM,CAACC,IAAP,CAAYR,KAAZ,CAAtB;OAA5B;KAHG;;IAKLS,SAAS,CAACC,IAAD,EAAOC,EAAP,EAAW;UACd,CAACV,MAAM,CAACU,EAAD,CAAX,EAAiB;YAEXC,GAAG,GAAG,KAAKC,KAAL,CAAWH,IAAX,CAAZ;;YACMI,KAAK,GAAG,IAAIC,WAAJ,CAAgBL,IAAhB,CAAd;;MACAM,iBAAI,CAACJ,GAAD,EAAM;QACRK,KAAK,EAAE,UAASC,IAAT,EAAeC,MAAf,EAAuB;cAE1BA,MAAM,IACNA,MAAM,CAACC,IAAP,KAAgB,mBADhB,IAEAF,IAAI,CAACE,IAAL,KAAc,SAHhB,EAIE;kBACMC,WAAW,GAAGrB,KAAK,CAACkB,IAAI,CAACI,KAAN,CAAzB;;gBACID,WAAJ,EAAiB;;cAEfP,KAAK,CAACS,SAAN,CAAgBL,IAAI,CAACM,KAAL,GAAa,CAA7B,EAAgCN,IAAI,CAACO,GAAL,GAAW,CAA3C,EAA8CJ,WAA9C;;;;OAVJ,CAAJ;aAeO;QACLX,IAAI,EAAEI,KAAK,CAACY,QAAN,EADD;QAELC,GAAG,EAAEb,KAAK,CAACc,WAAN;OAFP;;;GAzBJ;;;;;"}